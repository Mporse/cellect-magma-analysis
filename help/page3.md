# Running the web application (parameters)

When running the web application (under the "Run Analysis" tab), several options and parameters can be seen in the sidebar "Select Analysis Parameters" to the left on the screen. These will be described here.

## File paths

The various paths to files and folders the web application uses as input.

- **Write path to CELLEX file:** The path to the file with ESµ values (e.g. `mydataset.esmu.csv.gz`) outputted by the CELLEX tool.
- **Use pre-computed CELLEX values:** The output from running CELLEX on a mouse nervous system scRNA-seq dataset obtained from the _A. Zeisel et al. 2018_ study (https://doi.org/10.1016/j.cell.2018.06.021). I have bundled the CELLEX file with the web application, and the user can select this instead of uploading their own results.  
  _**NB:** Selecting this option disables the "Write path to CELLEX file" parameter._
- **Write path to CELLECT-MAGMA output folder:** The path to the CELLECT output folder generated by running the CELLECT-MAGMA workflow. To emphasize, it is the folder the user should point to, not any individual file.
- **Use pre-computed CELLECT results - schizophrenia:** The output from running CELLECT on summary statistics from a schizophrenia GWAS meta-analysis study, _The Schizophrenia Working Group of the Psychiatric Genomics Consortium et al. 2020_ (https://doi.org/10.1101/2020.09.12.20192922). I have bundled the output with the web application, and the user can select this instead of uploading their own results.  
  _**NB:** Selecting this option disables the "Write path to CELLECT-MAGMA output folder" parameter._
- **Use pre-computed CELLECT results - Parkinson's disease** The output from running CELLECT on summary statistics from a Parkinson's disease GWAS meta-analysis study, _M. A. Nalls et al. 2020_ (https://doi.org/10.1016/S1474-4422(19)30320-5). I have bundled the output with the web application, and the user can select this instead of uploading their own results.  
  _**NB:** Selecting this option disables the "Write path to CELLECT-MAGMA output folder" parameter._



## Top genes

CELLECT-MAGMA prioritizes cell types according to their significant association with the etiology of a given disease. However, it is also important to understand which genes _drive_ these prioritization results. To accomplish this, the web application creates a table named **Top genes** -  by default, the table contains genes which are among the top 1,000 most significant MAGMA genes (the genes with the lowest p-values, as calculated by MAGMA) and above the 90th percentile of ESµ values (the genes which are the most specifically expressed).

- **Number of MAGMA genes:** The number of most significant genes enriched for heritability signal to use (defaults to 1000). For instance, if the number is set to e.g. 500, then the 500 most significant MAGMA genes enriched for disease heritability signal will be selected.
- **Percentile of CELLEX values:** The percentile threshold for ESµ values above which the genes should be selected (defaults to 0.90). For instance, if the number is set to 0.95, then for each cell type the genes with an ESµ value that lies above the 95th percentile will be selected.

These two thresholds are also displayed on **Plot 2**.



## (Optional) Investigate Gene Set

Let's say you have set of genes (from an experiment, from a new publication you stumbled upon etc.) which you are interested in investigating further. You give the names of the genes as input to the web application, and it will highlight the location of these genes on the generated plots as well as perform an empirical Mann-Whitney U statistical test to determine whether the gene set is significant in regards to heritability and expression specificity (compared to the rest of the genes in the expression data). The parameters are as follows:

- **Upload your own gene set to investigate:** Whether or not to use a set of genes inputted by the user.
  - **Text input:** Displays a text box where you can write or copy-paste the set of genes to be investigated.
  - **File input:** Displays an option to upload a file with gene names. You need to answer whether the file has a head (column names) and which column the gene names are stored in (if applicable).
  - **Gene/protein name format:** What format the gene names are in. Options are ENSEMBL, HGNC, and UNIPROT formats, although the UNIPROT option has not been tested.

